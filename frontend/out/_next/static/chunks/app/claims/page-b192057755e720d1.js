(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1853],{23979:function(e,a,t){Promise.resolve().then(t.bind(t,29535))},29535:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return y}});var s=t(37821),r=t(65521),i=t(87769),n=t(67469),c=t(79578),o=t(15818),l=t(74242),d=t(58078),u=t(42347),m=t(21042),x=t(57751),h=t(27002),p=t(91027),f=t(54680);let j=e=>{switch(e){case"PAID":case"REFUNDED":return"success";case"SUBMITTED":default:return"default";case"READY_TO_SUBMIT":return"secondary";case"SUBMISSION_FAILED":case"REPORT_FAILED":return"destructive";case"NO_VIOLATION":case"NO_RESOURCES_LISTED":return"outline"}},v=["ALL","READY_TO_SUBMIT","SUBMITTED","SUBMISSION_FAILED","PAID","REFUNDED","NO_VIOLATION","NO_RESOURCES_LISTED","REPORT_FAILED"];function y(){let{t:e}=(0,r.$G)(),[a,t]=(0,d.useState)([]),[y,I]=(0,d.useState)([]),[g,E]=(0,d.useState)(!0),[b,N]=(0,d.useState)(null),[A,w]=(0,d.useState)("ALL"),[S,k]=(0,d.useState)(""),L=(0,d.useCallback)(async()=>{E(!0),N(null);try{let e=await fetch("/api/admin/claims");if(!e.ok)throw Error("Failed to fetch admin claims");let a=await e.json();t(a),I(a)}catch(e){N(e instanceof Error?e.message:"An unknown error occurred")}finally{E(!1)}},[]);(0,d.useEffect)(()=>{L()},[L]),(0,d.useEffect)(()=>{let e=a;if("ALL"!==A&&(e=e.filter(e=>e.status===A)),S){let a=S.toLowerCase();e=e.filter(e=>e.sk.toLowerCase().includes(a)||e.incidentId.toLowerCase().includes(a)||e.awsAccountId.toLowerCase().includes(a)||e.id.toLowerCase().includes(a))}I(e)},[a,A,S]);let D=async(e,a,t)=>{if(confirm("Tem certeza que deseja mudar o status da reivindica\xe7\xe3o ".concat(a.replace("CLAIM#","")," para ").concat(t,"?")))try{let s=await fetch("/api/admin/claims/".concat(e,"/").concat(a.replace("CLAIM#",""),"/status"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})});if(!s.ok){let e=await s.json();throw Error(e.message||"Failed to update claim status")}f.A.success("Status da reivindica\xe7\xe3o ".concat(a.replace("CLAIM#","")," atualizado para ").concat(t,".")),L()}catch(e){f.A.error("Erro ao atualizar status: ".concat(e instanceof Error?e.message:"Erro desconhecido"))}};return(0,s.jsx)(x.y,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(m.m,{title:"Claims",description:"Gerenciamento de Reivindica\xe7\xf5es"}),(0,s.jsxs)(i.Zb,{children:[(0,s.jsxs)(i.Ol,{children:[(0,s.jsx)(i.ll,{children:e("adminClaims.title","Gerenciamento de Reivindica\xe7\xf5es (Admin)")}),(0,s.jsx)(i.SZ,{children:e("adminClaims.description","Visualize e gerencie todas as reivindica\xe7\xf5es de cr\xe9dito SLA do sistema.")})]}),(0,s.jsxs)(i.aY,{children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[(0,s.jsx)(h.I,{placeholder:e("adminClaims.searchPlaceholder","Buscar por ID, incidente, conta AWS..."),value:S,onChange:e=>k(e.target.value),className:"flex-grow"}),(0,s.jsxs)(p.Ph,{value:A,onValueChange:w,children:[(0,s.jsx)(p.i4,{className:"w-[180px]",children:(0,s.jsx)(p.ki,{placeholder:e("adminClaims.filterByStatus","Filtrar por Status")})}),(0,s.jsx)(p.Bw,{children:v.map(a=>(0,s.jsx)(p.Ql,{value:a,children:e("statuses.".concat(a),a.replace(/_/g," "))},a))})]}),(0,s.jsx)(n.z,{onClick:L,variant:"outline",size:"icon",children:(0,s.jsx)(c.Z,{className:"h-4 w-4"})})]}),g&&(0,s.jsx)("p",{children:e("loading","Carregando...")}),b&&(0,s.jsxs)("p",{className:"text-red-500",children:[e("error","Erro"),": ",b]}),!g&&!b&&0===y.length&&(0,s.jsx)("p",{children:e("adminClaims.noClaims","Nenhuma reivindica\xe7\xe3o encontrada com os filtros aplicados.")}),!g&&!b&&y.length>0&&(0,s.jsx)("div",{className:"space-y-4",children:y.map(a=>{var t;return(0,s.jsx)(i.Zb,{children:(0,s.jsxs)(i.aY,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold",children:[e("adminClaims.claimId","Reivindica\xe7\xe3o ID"),": ",a.sk.replace("CLAIM#","")]}),(0,s.jsx)(u.C,{variant:j(a.status),children:e("statuses.".concat(a.status),a.status)})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e("adminClaims.customerId","Cliente ID"),": ",a.id]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e("adminClaims.incidentId","Incidente Associado"),": ",a.incidentId.replace("INCIDENT#","")]}),(0,s.jsxs)("p",{className:"mt-2",children:[e("adminClaims.awsAccount","Conta AWS"),": ",a.awsAccountId]}),(0,s.jsxs)("p",{children:[e("adminClaims.estimatedCredit","Cr\xe9dito Estimado"),": ",(0,s.jsxs)("span",{className:"font-medium",children:["$",(null===(t=a.creditAmount)||void 0===t?void 0:t.toFixed(2))||"0.00"]})]}),a.commissionAmount&&(0,s.jsxs)("p",{children:[e("adminClaims.commissionPaid","Comiss\xe3o Paga"),": ",(0,s.jsxs)("span",{className:"font-medium",children:["$",a.commissionAmount.toFixed(2)]})]}),a.caseId&&(0,s.jsxs)("p",{children:[e("adminClaims.supportCaseId","ID do Caso de Suporte AWS"),": ",(0,s.jsx)("span",{className:"font-medium",children:a.caseId})]}),a.stripeInvoiceId&&(0,s.jsxs)("p",{children:[e("adminClaims.stripeInvoiceId","ID da Fatura Stripe"),": ",(0,s.jsx)("span",{className:"font-medium",children:a.stripeInvoiceId})]}),a.submissionError&&(0,s.jsxs)("p",{className:"text-red-500",children:[e("adminClaims.submissionError","Erro no Envio"),": ",a.submissionError]}),(0,s.jsxs)("div",{className:"mt-4 space-x-2 flex flex-wrap gap-2",children:[a.reportUrl&&(0,s.jsx)("a",{href:a.reportUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center",children:(0,s.jsxs)(n.z,{variant:"outline",size:"sm",children:[(0,s.jsx)(o.Z,{className:"mr-2 h-4 w-4"})," ",e("adminClaims.downloadReport","Baixar Relat\xf3rio")]})}),a.caseId&&(0,s.jsx)("a",{href:"https://console.aws.amazon.com/support/cases/#/case/".concat(a.caseId),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center",children:(0,s.jsxs)(n.z,{variant:"outline",size:"sm",children:[(0,s.jsx)(l.Z,{className:"mr-2 h-4 w-4"})," ",e("adminClaims.viewSupportCase","Ver Caso de Suporte")]})}),"READY_TO_SUBMIT"===a.status&&(0,s.jsx)(n.z,{variant:"secondary",size:"sm",onClick:()=>C(a.id,a.sk),children:e("adminClaims.markAsRefundedAndInvoice","Marcar como Reembolsado (Gerar Fatura)")}),(0,s.jsxs)(p.Ph,{value:a.status,onValueChange:e=>D(a.id,a.sk,e),children:[(0,s.jsx)(p.i4,{className:"w-[200px]",children:(0,s.jsx)(p.ki,{placeholder:e("adminClaims.changeStatus","Mudar Status (Emerg\xeancia)")})}),(0,s.jsx)(p.Bw,{children:v.filter(e=>"ALL"!==e).map(a=>(0,s.jsx)(p.Ql,{value:a,children:e("statuses.".concat(a),a.replace(/_/g," "))},a))})]})]})]})},a.sk)})})]})]})]})})}let C=async(e,a)=>{let t=a.replace("CLAIM#","");if(confirm("Isso marcar\xe1 a claim ".concat(t," como REEMBOLSADA e GERAR\xc1 A FATURA de comiss\xe3o para o cliente. Continuar?")))try{let a=await fetch("/api/admin/claims/".concat(e,"/").concat(t,"/create-invoice"),{method:"POST"});if(!a.ok){let e=await a.json();throw Error(e.message||"Falha ao criar fatura")}let s=await a.json();f.A.success("Fatura ".concat(s.invoiceId," criada! Claim marcada como REFUNDED.")),fetchClaims()}catch(e){f.A.error("Erro: ".concat(e instanceof Error?e.message:"Erro desconhecido"))}}},57751:function(e,a,t){"use strict";t.d(a,{y:function(){return n}});var s=t(37821);t(58078);var r=t(41634),i=t(7794);let n=e=>{let{children:a}=e;return(0,s.jsx)(r.E.div,{variants:i.D_,initial:"initial",animate:"animate",exit:"exit",children:a})}},21042:function(e,a,t){"use strict";t.d(a,{m:function(){return r}});var s=t(37821);function r(e){let{title:a,description:t,children:r}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-start justify-between gap-4 border-b border-gray-200 pb-5 md:flex-row md:items-center",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold tracking-tight text-gray-900 sm:text-3xl",children:a}),t&&(0,s.jsx)("p",{className:"mt-1 text-base text-gray-500",children:t})]}),r&&(0,s.jsx)("div",{className:"flex shrink-0 items-center gap-2",children:r})]})}t(58078)},42347:function(e,a,t){"use strict";t.d(a,{C:function(){return r}});var s=t(37821);function r(e){var a;let{children:t,variant:r="default",className:i=""}=e,n={default:"bg-muted text-muted-foreground border border-border",success:"bg-primary/20 text-primary border border-primary/30 neon-text-primary",warning:"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30",danger:"bg-destructive/20 text-destructive border border-destructive/30",info:"bg-secondary/20 text-secondary border border-secondary/30 neon-text-secondary",secondary:"bg-accent text-accent-foreground border border-border",destructive:"bg-destructive/20 text-destructive border border-destructive/30",outline:"bg-transparent border border-input text-foreground"},c=null!==(a=n[r])&&void 0!==a?a:n.default;return(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(c," ").concat(i),children:t})}t(58078)},7794:function(e,a,t){"use strict";t.d(a,{CU:function(){return r},D_:function(){return n},Jm:function(){return s},yR:function(){return i}});let s={animate:{transition:{staggerChildren:.1}}},r={initial:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{duration:.3}}},i={y:-2,transition:{duration:.15}},n={initial:{opacity:0,y:10},animate:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}},exit:{opacity:0,y:-10,transition:{duration:.2}}}},15818:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(38322).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},74242:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(38322).Z)("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]])},79578:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(38322).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},function(e){e.O(0,[4654,1634,4680,5521,6354,7115,2364,1744],function(){return e(e.s=23979)}),_N_E=e.O()}]);