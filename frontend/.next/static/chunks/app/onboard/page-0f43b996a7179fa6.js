(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[413],{4649:function(e,a,t){Promise.resolve().then(t.bind(t,4372))},4372:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return Onboard}});var n=t(7821),r=t(6106),o=t(6169),s=t(8078),c=t(6179);function Onboard(){let{t:e}=(0,r.$G)(),[a,t]=(0,s.useState)(""),[i,l]=(0,s.useState)("PENDING_CFN"),[u,d]=(0,s.useState)(!1),m=(0,c.useRouter)(),p=(0,s.useCallback)(async()=>{let e=await fetch("/api/onboard-init");if(e.ok){let a=await e.json();if(!1===a.termsAccepted){m.push("/terms");return}l(a.status),"COMPLETED"===a.status&&m.push("/dashboard")}},[m]),x=(0,s.useCallback)(async()=>{let e=await fetch("/api/onboard-init",{headers:{}});if(e.ok){let a=await e.json();l(a.status);let n="".concat(window.location.origin,"/api/onboard"),r="https://console.aws.amazon.com/cloudformation/home?region=us-east-1#/stacks/create/review?templateURL=".concat("https://s3.amazonaws.com/cost-guardian-templates/cost-guardian-template.yaml","&stackName=CostGuardianStack&param_ExternalId=").concat(a.externalId,"&param_PlatformAccountId=").concat(a.platformAccountId,"&param_CallbackUrl=").concat(encodeURIComponent(n));t(r)}},[]);return(0,s.useEffect)(()=>{x()},[x]),(0,s.useEffect)(()=>{if(u&&"COMPLETED"!==i){let e=setInterval(p,5e3);return()=>clearInterval(e)}},[u,i,p]),(0,n.jsxs)("div",{className:"p-8",children:[(0,n.jsx)("h1",{children:e("connectAws")}),"COMPLETED"===i?(0,n.jsxs)("div",{className:"mt-4 p-4 bg-green-100 text-green-800 rounded",children:[(0,n.jsx)("p",{children:"âœ… Conex\xe3o com a AWS realizada com sucesso!"}),(0,n.jsx)("p",{children:"Voc\xea ser\xe1 redirecionado para o dashboard..."})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.z,{onClick:()=>{a?(window.open(a,"_blank"),d(!0)):alert("Gerando link de conex\xe3o, por favor aguarde...")},className:"mt-4",disabled:!a||u,children:u?"Aguardando conex\xe3o...":"1. Conectar AWS (Abrir CloudFormation)"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:u?"Ap\xf3s criar a stack no console da AWS, pode fechar a aba e voltar para c\xe1. Estamos aguardando a confirma\xe7\xe3o autom\xe1tica.":"Isto abrir\xe1 o console da AWS para voc\xea criar a role de acesso. \xc9 seguro e transparente."})]})]})}},6169:function(e,a,t){"use strict";t.d(a,{z:function(){return Button}});var n=t(7821),r=t(8078),o=t(9544);function Button(e){let{className:a,variant:t="default",size:s="default",asChild:c=!1,children:i,...l}=e,u=(0,o.cn)("inline-flex items-center justify-center rounded font-medium","outline"===t?"border border-gray-300 bg-white text-gray-800":"secondary"===t?"bg-gray-100 text-gray-800":"bg-blue-500 text-white","sm"===s?"px-3 py-1.5 text-sm":"icon"===s?"p-2 text-sm":"px-4 py-2 text-base",a||"");return c&&i&&(0,r.isValidElement)(i)?r.cloneElement(i,{className:(0,o.cn)(u,i.props.className),...l}):(0,n.jsx)("button",{className:u,...l,children:i})}},9544:function(e,a,t){"use strict";t.d(a,{cn:function(){return cn}});var n=t(7683),r=t(188);function cn(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,r.m6)((0,n.W)(a))}},6179:function(e,a,t){e.exports=t(5353)}},function(e){e.O(0,[106,779,115,835,744],function(){return e(e.s=4649)}),_N_E=e.O()}]);